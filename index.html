<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Operation Project Numero Uno</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Metal+Mania&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

</head>

<body>
    <div class="wrapper">
        <div class="container-fluid">
            <div class="jumbotron text-center">
                <h1>Forbade</h1>
                <p>Make use of what's left of your world!</p>
            </div>
        </div>
        <div class="container">
            <div id="choices">
                <button class="choice-button find-food">Find Food</button>
                <button class="choice-button find-water">Find Water</button>
                <button class="choice-button find-medicine">Find Medicine</button>
            </div>
            <footer id="player-status-interface">
                <div id="player-status" class="container">
                    <div class="status-item"><i class="fas fa-user"></i> Name: <span id="name"></span></div>
                    <div class="status-item"><i class="fas fa-heart"></i> Health: <span id="health">10</span></div>
                    <div class="status-item"><i class="fas fa-drumstick-bite"></i> Hunger: <span id="hunger">0</span></div>
                    <div class="status-item"><i class="fas fa-tint-slash"></i> Thirst: <span id="thirst">0</span></div>
                </div>
            </footer>
        </div>
    </div>
</body>
<script src="index.js"></script>
<script>
    class DB {
        constructor() {
            this.storage = window.localStorage;
            this.getPlayer = this.getPlayer.bind(this)
            this.addPlayer = this.addPlayer.bind(this)
            this.updatePlayer = this.updatePlayer.bind(this)
            this.removePlayer = this.removePlayer.bind(this)
            this.nuclearBomb = this.nuclearBomb.bind(this)
        }

        addPlayer(str, obj) {
            if (this.storage.getItem(str)) {
                console.log(`Player already exists!!`);
            } else {
                this.storage.setItem(str, JSON.stringify(obj))
                console.log(`Player ${str} created`)
            }
        }

        getPlayer(str) {
            if (!this.storage.getItem(str)) {
                console.log(`Player not found!`)
            } else {
                const player = JSON.parse(this.storage.getItem(str))
                console.log(`player -->`, player)
                return player
            }
        }

        updatePlayer(str, obj) {
            this.storage.removeItem(str);
            this.storage.setItem(str, JSON.stringify(obj))
            console.log(`update obj-->`, obj)
            return obj;
        }

        removePlayer(str) {
            this.storage.removeItem(str);
        }

        listAllPlayers() {
            console.log(Object.keys(this.storage))
            return Object.keys(this.storage)
        }

        listAllPlayerObjects() {
            const allKeys = [];
            const keys = Object.keys(this.storage);
            let i = keys.length;

            while (i--) {
                allKeys.push(this.storage.getItem(keys[i]))
            }
            console.log(`allKeys-->`, allKeys)
            return allKeys;
        }

        allStorage() {
            const storageObj = {};
            const keys = Object.keys(this.storage)
            let i = keys.length;

            while (i--) {
                storageObj[keys[i]] = JSON.parse(this.storage.getItem(keys[i]));
            }
            console.log(`STORAGE OBJECT---->`, storageObj)
            return storageObj;
        }

        nuclearBomb() {
            this.storage.clear();
        }
    }

    const db = new DB()


    // Setup a player object
    class Player {
        constructor(name) {
            this.name = name,
                this.hunger = 0,
                this.thirst = 0,
                this.health = 10,
                this.eat = this.eat.bind(this),
                this.drink = this.drink.bind(this),
                this.hungry = this.hungry.bind(this),
                this.heal = this.heal.bind(this),
                this.damage = this.damage.bind(this)
        }

        //Add player methods

        //EAT
        eat(num) {
            this.hunger -= num
        }

        //HUNGER
        hungry(num) {
            this.hunger += num
        }

        //THIRSTY
        thirsty(num) {
            this.thirst += num
        }

        //DRINK
        drink(num) {
            this.thirst -= num
        }

        //HEAL
        heal(num) {
            this.health += num
        }

        //TAKE DAMAGE
        damage(num) {
            this.health -= num
        }

    }


    let Game = {
        player: new Player('Frank'),
        location: {
            coordinates: {
                lat: 0.0,
                lng: 0.0
            },
            nearbyResources: [],
            foodScore: 3,
            waterScore: 3,
            medScore: 3
        },
        getlocScores: function() {
            if (nearbyResources.length != -1) {
                console.log("Do stuff");
            }
        },
        updateDisplay: function() {
            $("#name").text(this.player.name)
            $("#health").text(this.player.health);
            $("#hunger").text(this.player.hunger);
            $("#thirst").text(this.player.thirst);
        }
    }

    $(document).ready(function() {
        Game.updateDisplay();
    });

    // Adjust points on location change
    $('.choice-button').on('click', function() {
        // subtract health if hunger or thirst are too high
        if (Game.player.hunger > 8) {
            Game.player.damage(1);
        }
        if (Game.player.thirst > 8) {
            Game.player.damage(1);
        }

        // Default hunger and thirst updates
        Game.player.hungry(1);
        Game.player.thirsty(2)

        if ($(this).hasClass("find-food")) {
            if (Game.player.hunger > 0) {
                Game.player.eat(3);
            }
            if (Game.player.hunger < 1) {
                Game.player.hunger = 0;
            }
        }

        if ($(this).hasClass("find-water")) {
            if (Game.player.thirst > 0) {
                Game.player.drink(3);
            }
            if (Game.player.thirst < 1) {
                Game.player.thirst = 0;
            }
        }

        if ($(this).hasClass("find-medicine")) {
            Game.player.heal(3);
        }


        // Update display
        Game.updateDisplay();
    });
</script>

</html>